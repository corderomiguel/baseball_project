---
title: "prueba de bondad de ajuste X1"
author: "Luis Riera"
date: "20 de abril de 2022"
output: pdf_document
---

```{r include=FALSE}
# Inicializamos la librería que permite leer archivos xlsx
library(readxl)
# Asignamos a una variable la información almacenada en el archivo
Baseball <- read_excel("../../data/Baseball.xlsx")
# Mostramos las primeras 5 entradas
head(Baseball, n=5)
```

```{r include=FALSE}
X1<-Baseball$X1
X1
```

Usando el comando `hist` podemos obtener el histograma de la variables y la descripción de los puntos de corte de cada frecuencia

```{r}
hist(X1,main = "Histograma variable X1", ylab = "Frecuencia", xlab = "X1: Hits al bate", col="Yellow")
hist(X1,plot=F)
```
 
partiremos los datos en varias categorías: 

* Primera categoría (o clase): $[0.18,0.24)$ con frecuencia observada $f_{1}=8$
* Segunda categoría (o clase): $[0.24,0.28)$ con frecuencia observada $f_{2}=11$
* Tercera categoría (o clase): $[0.28,0.30)$ con frecuencia observada $f_{3}=9$
* Cuarta categoría (o clase): $[0.30,0.32)$ con frecuencia observada $f_{4}=10$ 
* Quinta categoría (o clase): $[0.32,0.38]$ con frecuencia observada $f_{5}=7$


En `R` podemmos realizar un estudio previo de normalidad para ver si los datos se están ajustando a una distribución normal 
```{r}
# Frecuencias observadas
fi<-c(8,11,9,10,7)
qqnorm(fi)
qqline(fi)
```

Los datos agrupados pareciera ajustarse bastante bien a los datos

```{r}
# Tamaño de los fi
(k<- length(fi))
```

```{r}
# Numero total de datos 
n<- sum(fi)
# Puntos medios de los intervalos
(mi<-c(0.18+(0.24-0.18)/2,0.24+(0.28-0.24)/2,0.28+(0.30-0.28)/2,0.30+(0.32-0.30)/2, 0.32+(0.38-0.32)/2))
# Media de los datos
(xbarra<-sum(fi*mi)/n)
# Vector con las medias
x_barra<-rep(xbarra,k)

# Varianza 
(S_cuadrado<-sum(fi*(mi-x_barra)^{2})/(n-1))
# Desviación estandar
(S<-sqrt(S_cuadrado))
```

calculemos los pi

```{r}
# P(Z<0.24)
(p1<-pnorm(0.24,mean= xbarra,sd=S))
# P(0.24 < Z < 0.28) 
(p2<-pnorm(0.28,mean= xbarra,sd=S)-pnorm(0.24,mean= xbarra,sd=S))
(p3<-pnorm(0.30,mean= xbarra,sd=S)-pnorm(0.28,mean= xbarra,sd=S))
(p4<-pnorm(0.32,mean= xbarra,sd=S)-pnorm(0.30,mean= xbarra,sd=S))
(p5<-pnorm(0.32,mean= xbarra,sd=S, lower.tail = F))

# Vector con las probabilidades
(pi<-c(p1,p2,p3,p4,p5))
# Suma de las probabilidades
(sum(pi))
```



```{r}
# Estadistico
(t<-sum(((fi-n*pi)^{2})/(n*pi)))
```

```{r}
# p-valor
(p_Valor<- 1-pchisq(t,k-1-2))
```



















